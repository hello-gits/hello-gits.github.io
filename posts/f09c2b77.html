<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Ambari 介绍 一、环境安装, hnbian">
    <meta name="description" content="1. Ambari 介绍Ambari 是 Apache Software Foundation 中的一个顶级项目。就 Ambari 的作用来说，就是创建、管理、监视 Hadoop 的集群，但是这里的 Hadoop 是广义，指的是 Hadoo">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Ambari 介绍 一、环境安装 | hnbian</title>
    <link rel="icon" type="image/png" href="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB">

    <link rel="stylesheet" type="text/css" href="https://images.hnbian.cn/all.css">
    <link rel="stylesheet" type="text/css" href="https://images.hnbian.cn/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://images.hnbian.cn/aos.css">
    <link rel="stylesheet" type="text/css" href="https://images.hnbian.cn/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://images.hnbian.cn/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="https://images.hnbian.cn/jquery.min.mind.js"></script>
    <script data-ad-client="ca-pub-5756598031349071" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="google-site-verification" content="GrFMoauFrf8T4o0YL7D2b8YqhXQwVruyJKGw57gZ8J4">
<link rel="alternate" href="/atom.xml" title="hnbian" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">hnbian</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/graph" class="waves-effect waves-light">
      
      <i class="fa fa-graduation-cap" style="zoom: 0.6;"></i>
      
      <span>知识图谱</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="https://images.hnbian.cn/FvNSAGx7xljxALFh8Fa2DPNFP-JB" class="logo-img circle responsive-img">
        
        <div class="logo-name">hnbian</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/graph" class="waves-effect waves-light">
			
			    <i class="fa-fw fa fa-graduation-cap"></i>
			
			知识图谱
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/hnbian" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/hnbian" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('https://images.hnbian.cn/FjyEghfHedrO-eZ5olryEvUMFXuj')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Ambari 介绍 一、环境安装</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://images.hnbian.cn/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/ambari/">
                                <span class="chip bg-color">ambari</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/ambari/" class="post-category">
                                ambari
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-03-14
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    31 分
                </div>
                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="1-Ambari-介绍"><a href="#1-Ambari-介绍" class="headerlink" title="1. Ambari 介绍"></a>1. Ambari 介绍</h2><p><a href="http://ambari.apache.org/" target="_blank" rel="noopener">Ambari</a> 是 Apache Software Foundation 中的一个顶级项目。就 Ambari 的作用来说，就是创建、管理、监视 Hadoop 的集群，但是这里的 Hadoop 是广义，指的是 Hadoop 整个生态圈（例如 Hive，Hbase，Sqoop，Zookeeper 等），而并不仅是特指 Hadoop。用一句话来说，Ambari 就是为了让 Hadoop 以及相关的大数据软件更容易使用的一个工具。</p>
<h2 id="2-环境说明"><a href="#2-环境说明" class="headerlink" title="2. 环境说明"></a>2. 环境说明</h2><table>
<thead>
<tr>
<th>组件</th>
<th>版本</th>
</tr>
</thead>
<tbody><tr>
<td>Centos</td>
<td>7.5</td>
</tr>
<tr>
<td>Ambari</td>
<td>2.7.3</td>
</tr>
<tr>
<td>HDP</td>
<td>3.1.0.0</td>
</tr>
<tr>
<td>HDP-GPL</td>
<td>3.1.0.0</td>
</tr>
<tr>
<td>HDP-UTILS</td>
<td>1.1.0.22</td>
</tr>
<tr>
<td>MySQL</td>
<td>5.7</td>
</tr>
<tr>
<td>OracleJDK8</td>
<td>1.8.0_191-b12</td>
</tr>
<tr>
<td>X86</td>
<td>X86-64</td>
</tr>
</tbody></table>
<br>

<table>
<thead>
<tr>
<th>节点</th>
<th>部署服务</th>
</tr>
</thead>
<tbody><tr>
<td>hnode1</td>
<td>ambari server</td>
</tr>
<tr>
<td>hnode2</td>
<td>ambari agent</td>
</tr>
<tr>
<td>hnode3</td>
<td>ambari agent</td>
</tr>
</tbody></table>
<h2 id="3-安装集群时间同步服务（ntpd）"><a href="#3-安装集群时间同步服务（ntpd）" class="headerlink" title="3. 安装集群时间同步服务（ntpd）"></a>3. 安装集群时间同步服务（ntpd）</h2><p>三个节点上都要安装 </p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true">#安装时间同步服务（ntp）</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> yum <span class="token function">install</span> ntp
Loaded plugins: fastestmirror, refresh-packagekit, security
Loading mirror speeds from cached hostfile
 * base: ftp.sjtu.edu.cn
 * extras: ap.stykers.moe
 * updates: mirror.bit.edu.cn

<span class="token comment" spellcheck="true"># 强制从远程更新</span>
<span class="token punctuation">[</span>root@hnode3 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># sudo ntpdate 0.centos.pool.ntp.org</span>
28 Apr 15:54:51 ntpdate<span class="token punctuation">[</span>75627<span class="token punctuation">]</span>: step <span class="token function">time</span> server 193.4.58.77 offset 2443633.848252 sec

<span class="token comment" spellcheck="true"># 启动服务</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> systemctl start ntpd.service
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 检查服务状态</span>
<span class="token punctuation">[</span>root@hnode3 ~<span class="token punctuation">]</span> systemctl status ntpd.service
● ntpd.service - Network Time Service
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/ntpd.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since 一 2020-03-30 16:26:16 CST<span class="token punctuation">;</span> 37min ago

<span class="token comment" spellcheck="true"># 设置开机启动</span>
<span class="token punctuation">[</span>root@hnode3 ~<span class="token punctuation">]</span> systemctl <span class="token function">enable</span> ntpd.service

<span class="token comment" spellcheck="true"># 检查开机启动是否设置成功</span>
<span class="token punctuation">[</span>root@hnode3 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl is-enabled ntpd</span>
enabled
</code></pre>
<h2 id="4-关闭防火墙"><a href="#4-关闭防火墙" class="headerlink" title="4. 关闭防火墙"></a>4. 关闭防火墙</h2><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 查看防火墙状态</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> firewall-cmd --state
running
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 关闭防火墙</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> systemctl stop firewalld.service
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 查看防火墙状态</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> firewall-cmd --state
not running
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 关闭防火墙开机启动</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> systemctl disable firewalld.service
</code></pre>
<ul>
<li>关闭 selinux</li>
</ul>
<pre class=" language-bash"><code class="language-bash">vim /etc/selinux/config

<span class="token comment" spellcheck="true"># 将 SELINUX=enforcing 修改为：</span>
SELINUX<span class="token operator">=</span>disabled

<span class="token comment" spellcheck="true"># 重启服务器后查看 SELINUX 状态</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># sestatus</span>
SELinux status:                 disabled</code></pre>
<h2 id="5-设置免密登录"><a href="#5-设置免密登录" class="headerlink" title="5. 设置免密登录"></a>5. 设置免密登录</h2><p>设置免密登录，从hnode1 免密登录到hnode2、hnode3</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># home下创建.ssh目录</span>
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> <span class="token function">mkdir</span> .ssh
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> <span class="token function">cd</span> .ssh/
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> <span class="token function">pwd</span>
/root/.ssh
<span class="token comment" spellcheck="true"># 生成秘钥</span>
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter <span class="token function">file</span> <span class="token keyword">in</span> <span class="token function">which</span> to save the key <span class="token punctuation">(</span>/root/.ssh/id_rsa<span class="token punctuation">)</span>: （回车）
Enter passphrase <span class="token punctuation">(</span>empty <span class="token keyword">for</span> no passphrase<span class="token punctuation">)</span>:（回车）
Enter same passphrase again:（回车）
Your identification has been saved <span class="token keyword">in</span> /root/.ssh/id_rsa.
Your public key has been saved <span class="token keyword">in</span> /root/.ssh/id_rsa.pub.
The key fingerprint is:
SHA256:F1XLKMmnivY288gcK5IsY90xm0kawlM62D+uyGIeB0k root@hnode1
The keys randomart image is:
+---<span class="token punctuation">[</span>RSA 2048<span class="token punctuation">]</span>----+
<span class="token operator">|</span>            <span class="token punctuation">..</span>.  <span class="token operator">|</span>
<span class="token operator">|</span>         <span class="token keyword">.</span> o o <span class="token keyword">.</span> <span class="token operator">|</span>
<span class="token operator">|</span> E        <span class="token operator">=</span> o o  <span class="token operator">|</span>
<span class="token operator">|</span><span class="token keyword">.</span> <span class="token keyword">.</span> <span class="token keyword">.</span>      <span class="token operator">=</span>     <span class="token operator">|</span>
<span class="token operator">|</span> * o    S o      <span class="token operator">|</span>
<span class="token operator">|</span><span class="token keyword">.</span> O <span class="token keyword">.</span> +. o       <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">.</span> O *o*o        <span class="token operator">|</span>
<span class="token operator">|</span>oo* O.*+++       <span class="token operator">|</span>
<span class="token operator">|</span><span class="token operator">=</span>+.<span class="token operator">=</span>.o o*+.      <span class="token operator">|</span>
+----<span class="token punctuation">[</span>SHA256<span class="token punctuation">]</span>-----+
<span class="token comment" spellcheck="true"># 查看生成的文件</span>
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> ll
总用量 8
-rw-------. 1 root root 1675 3月  30 18:58 id_rsa
-rw-r--r--. 1 root root  393 3月  30 18:58 id_rsa.pub

<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true">#将公钥拷贝到hnode2、hnode3</span>
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> ssh-copy-id hnode2
<span class="token punctuation">..</span>.
root@hnode2s password: <span class="token comment" spellcheck="true"># (输入hnode2的密码)</span>
<span class="token punctuation">..</span>.

<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 尝试登陆hnode2</span>
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> <span class="token function">ssh</span> hnode2
Last login: Mon Mar 30 18:32:21 2020 from hnode1 <span class="token comment" spellcheck="true"># 登陆成功</span>
Last login: Mon Mar 30 18:32:21 2020 from hnode1
<span class="token comment" spellcheck="true"># 登出</span>
<span class="token punctuation">[</span>root@hnode2 ~<span class="token punctuation">]</span> <span class="token keyword">exit</span>
Connection to hnode2 closed.

<span class="token comment" spellcheck="true">#将秘钥拷贝到hnode3</span>
<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> ssh-copy-id hnode3
<span class="token punctuation">..</span>.
root@hnode3s password: <span class="token comment" spellcheck="true"># (输入hnode3的密码)</span>
<span class="token punctuation">..</span>.

<span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span> <span class="token function">ssh</span> hnode3
Last login: Mon Mar 30 17:50:57 2020 from hnode1
<span class="token comment" spellcheck="true"># 登出</span>
<span class="token punctuation">[</span>root@hnode3 ~<span class="token punctuation">]</span> <span class="token keyword">exit</span>
Connection to hnode3 closed.
</code></pre>
<p><img src="https://images.hnbian.cn/FibfUAY6fojeMM0yABALNY9lsbzy?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="免密登录大致原理"></p>
<h2 id="6-安装Java"><a href="#6-安装Java" class="headerlink" title="6. 安装Java"></a>6. 安装Java</h2><p>三个节点上都要安装</p>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 解压安装包</span>
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> <span class="token function">tar</span> -zxvf jdk-8u191-linux-x64.tar.gz
root@hnode1 opt<span class="token punctuation">]</span> <span class="token function">cd</span> jdk1.8.0_191/
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> ll
总用量 25976
drwxr-xr-x. 2 10 143     4096 10月  6 2018 bin
-r--r--r--. 1 10 143     3244 10月  6 2018 COPYRIGHT
drwxr-xr-x. 3 10 143      132 10月  6 2018 include
-rw-r--r--. 1 10 143  5207154 9月  12 2018 javafx-src.zip
drwxr-xr-x. 5 10 143      185 10月  6 2018 jre
drwxr-xr-x. 5 10 143      245 10月  6 2018 lib
-r--r--r--. 1 10 143       40 10月  6 2018 LICENSE
drwxr-xr-x. 4 10 143       47 10月  6 2018 <span class="token function">man</span>
-r--r--r--. 1 10 143      159 10月  6 2018 README.html
-rw-r--r--. 1 10 143      424 10月  6 2018 release
-rw-r--r--. 1 10 143 21101479 10月  6 2018 src.zip
-rw-r--r--. 1 10 143   108062 9月  12 2018 THIRDPARTYLICENSEREADME-JAVAFX.txt
-r--r--r--. 1 10 143   155003 10月  6 2018 THIRDPARTYLICENSEREADME.txt
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> <span class="token function">pwd</span>
/opt/jdk1.8.0_191
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true"># 配置环境变量</span>
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> vim /etc/profile

<span class="token comment" spellcheck="true"># 文件底部增加如下配置</span>

<span class="token comment" spellcheck="true"># jdk 安装地址</span>
<span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/opt/jdk1.8.0_191

PATH<span class="token operator">=</span><span class="token variable">$PATH</span><span class="token keyword">:</span><span class="token variable">$JAVA_HOME</span>/bin

<span class="token comment" spellcheck="true"># 刷新配置文件</span>
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> <span class="token function">source</span> /etc/profile
<span class="token comment" spellcheck="true"># 打印Java home</span>
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> <span class="token keyword">echo</span> <span class="token variable">$JAVA_HOME</span>
/opt/jdk1.8.0_191
<span class="token comment" spellcheck="true"># 查看 java 版本进行验证</span>
<span class="token punctuation">[</span>root@hnode1 jdk1.8.0_191<span class="token punctuation">]</span> java -version
<span class="token comment" spellcheck="true"># 打印除下列 java 版本信息 说明jdk安装成功</span>
java version <span class="token string">"1.8.0_191"</span>
Java<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> SE Runtime Environment <span class="token punctuation">(</span>build 1.8.0_191-b12<span class="token punctuation">)</span>
Java HotSpot<span class="token punctuation">(</span>TM<span class="token punctuation">)</span> 64-Bit Server VM <span class="token punctuation">(</span>build 25.191-b12, mixed mode<span class="token punctuation">)</span></code></pre>
<h2 id="7-安装MySQL"><a href="#7-安装MySQL" class="headerlink" title="7. 安装MySQL"></a>7. 安装MySQL</h2><h3 id="7-1-下载MySQL"><a href="#7-1-下载MySQL" class="headerlink" title="7.1 下载MySQL"></a>7.1 下载MySQL</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 下载 MySQL</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> <span class="token function">wget</span> -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm
--2020-03-30 19:35:18--  http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm
正在解析主机 dev.mysql.com <span class="token punctuation">(</span>dev.mysql.com<span class="token punctuation">)</span><span class="token punctuation">..</span>. 137.254.60.11
正在连接 dev.mysql.com <span class="token punctuation">(</span>dev.mysql.com<span class="token punctuation">)</span><span class="token operator">|</span>137.254.60.11<span class="token operator">|</span>:80<span class="token punctuation">..</span>. 已连接。
已发出 HTTP 请求，正在等待回应<span class="token punctuation">..</span>. 301 Moved Permanently
位置：https://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm <span class="token punctuation">[</span>跟随至新的 URL<span class="token punctuation">]</span>
--2020-03-30 19:35:22--  https://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm
正在连接 dev.mysql.com <span class="token punctuation">(</span>dev.mysql.com<span class="token punctuation">)</span><span class="token operator">|</span>137.254.60.11<span class="token operator">|</span>:443<span class="token punctuation">..</span>. 已连接。
已发出 HTTP 请求，正在等待回应<span class="token punctuation">..</span>. 302 Found
位置：https://repo.mysql.com//mysql57-community-release-el7-10.noarch.rpm <span class="token punctuation">[</span>跟随至新的 URL<span class="token punctuation">]</span>
--2020-03-30 19:35:30--  https://repo.mysql.com//mysql57-community-release-el7-10.noarch.rpm
正在解析主机 repo.mysql.com <span class="token punctuation">(</span>repo.mysql.com<span class="token punctuation">)</span><span class="token punctuation">..</span>. 223.119.236.209
正在连接 repo.mysql.com <span class="token punctuation">(</span>repo.mysql.com<span class="token punctuation">)</span><span class="token operator">|</span>223.119.236.209<span class="token operator">|</span>:443<span class="token punctuation">..</span>. 已连接。
已发出 HTTP 请求，正在等待回应<span class="token punctuation">..</span>. 200 OK
长度：25548 <span class="token punctuation">(</span>25K<span class="token punctuation">)</span> <span class="token punctuation">[</span>application/x-redhat-package-manager<span class="token punctuation">]</span>
正在保存至: “mysql57-community-release-el7-10.noarch.rpm”

100%<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">></span><span class="token punctuation">]</span> 25,548      71.4KB/s 用时 0.3s

2020-03-30 19:35:33 <span class="token punctuation">(</span>71.4 KB/s<span class="token punctuation">)</span> - 已保存 “mysql57-community-release-el7-10.noarch.rpm” <span class="token punctuation">[</span>25548/25548<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 安装mysql </span>

yum -y <span class="token function">install</span> mysql57-community-release-el7-10.noarch.rpm
yum -y <span class="token function">install</span> mysql-community-server
</code></pre>
<h3 id="7-2-启动mysql并设置开机自启"><a href="#7-2-启动mysql并设置开机自启" class="headerlink" title="7.2 启动mysql并设置开机自启"></a>7.2 启动mysql并设置开机自启</h3><pre class=" language-bash"><code class="language-bash">systemctl start mysqld.service    <span class="token comment" spellcheck="true"># 启动mysql</span>
systemctl status mysqld.service  <span class="token comment" spellcheck="true"># 查看mysql状态</span>
systemctl stop mysqld.service   <span class="token comment" spellcheck="true"># 关闭mysql</span>
systemctl <span class="token function">enable</span> mysqld.service   <span class="token comment" spellcheck="true"># 开机自启</span></code></pre>
<h3 id="7-3-配置mysql编码，字符格式："><a href="#7-3-配置mysql编码，字符格式：" class="headerlink" title="7.3 配置mysql编码，字符格式："></a>7.3 配置mysql编码，字符格式：</h3><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> vim /etc/my.cnf 

<span class="token comment" spellcheck="true"># 文件底部添加下面代码</span>

log-error<span class="token operator">=</span>/var/log/mysqld.log
pid-file<span class="token operator">=</span>/var/run/mysqld/mysqld.pid
collation_server<span class="token operator">=</span>utf8_general_ci
character_set_server<span class="token operator">=</span>utf8
default-storage-engine<span class="token operator">=</span>INNODB</code></pre>
<h3 id="7-4-运行mysql-安全配置向导"><a href="#7-4-运行mysql-安全配置向导" class="headerlink" title="7.4 运行mysql 安全配置向导"></a>7.4 运行mysql 安全配置向导</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 安装之后的密码会存在/var/log/mysqld.log 文件中</span>

<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> <span class="token function">cat</span> /var/log/mysqld.log
2020-03-30T11:57:32.968090Z 0 <span class="token punctuation">[</span>Warning<span class="token punctuation">]</span> TIMESTAMP <span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
2020-03-30T11:57:33.657151Z 1 <span class="token punctuation">[</span>Note<span class="token punctuation">]</span> A temporary password is generated <span class="token keyword">for</span> root@localhost: o6<span class="token punctuation">)</span>j<span class="token operator">!</span>d<span class="token punctuation">;</span>l<span class="token operator">></span>iQz

<span class="token punctuation">(</span>o6<span class="token punctuation">)</span>j<span class="token operator">!</span>d<span class="token punctuation">;</span>l<span class="token operator">></span>iQz<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 就是 MySQL 的初始密码</span>



<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> mysql_secure_installation

Securing the MySQL server deployment.

Enter password <span class="token keyword">for</span> user root: <span class="token comment" spellcheck="true"># 刚刚查询到的MySQL初始密码(o6)j!d;l>iQz)</span>

The existing password <span class="token keyword">for</span> the user account root has expired. Please <span class="token keyword">set</span> a new password.

New password: <span class="token comment" spellcheck="true"># 新的密码 （Admin123!）</span>

Re-enter new password: <span class="token comment" spellcheck="true"># 新的密码</span>


By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created <span class="token keyword">for</span> them. This is intended only <span class="token keyword">for</span>
testing, and to <span class="token function">make</span> the installation go a bit smoother.
You should remove them before moving into a production
environment.

Remove anonymous users? <span class="token punctuation">(</span>Press y<span class="token operator">|</span>Y <span class="token keyword">for</span> Yes, any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> <span class="token keyword">:</span> y <span class="token comment" spellcheck="true">#是否删除匿名用户,生产环境建议删除</span>
Success.


Normally, root should only be allowed to connect from
<span class="token string">'localhost'</span><span class="token keyword">.</span> This ensures that someone cannot guess at
the root password from the network.

Disallow root login remotely? <span class="token punctuation">(</span>Press y<span class="token operator">|</span>Y <span class="token keyword">for</span> Yes, any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> <span class="token keyword">:</span> n <span class="token comment" spellcheck="true">#是否禁止root远程登录,根据自己的需求选择y/n并回车</span>

 <span class="token punctuation">..</span>. skipping.
By default, MySQL comes with a database named <span class="token string">'test'</span> that
anyone can access. This is also intended only <span class="token keyword">for</span> testing,
and should be removed before moving into a production
environment.


Remove <span class="token function">test</span> database and access to it? <span class="token punctuation">(</span>Press y<span class="token operator">|</span>Y <span class="token keyword">for</span> Yes, any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> <span class="token keyword">:</span> n <span class="token comment" spellcheck="true">#是否删除test数据库</span>

 <span class="token punctuation">..</span>. skipping.
Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? <span class="token punctuation">(</span>Press y<span class="token operator">|</span>Y <span class="token keyword">for</span> Yes, any other key <span class="token keyword">for</span> No<span class="token punctuation">)</span> <span class="token keyword">:</span> y <span class="token comment" spellcheck="true">#是否重新加载权限表</span>
Success.

All done<span class="token operator">!</span>
</code></pre>
<h3 id="7-5-测试连接MySQL"><a href="#7-5-测试连接MySQL" class="headerlink" title="7.5 测试连接MySQL"></a>7.5 测试连接MySQL</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 命令行中连接MySQL</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> mysql -u root -p
Enter password: （Admin123<span class="token operator">!</span>）
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or \g.
Your MySQL connection <span class="token function">id</span> is 9
Server version: 5.7.29 MySQL Community Server <span class="token punctuation">(</span>GPL<span class="token punctuation">)</span>

Copyright <span class="token punctuation">(</span>c<span class="token punctuation">)</span> 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <span class="token string">'help;'</span> or <span class="token string">'\h'</span> <span class="token keyword">for</span> help. Type <span class="token string">'\c'</span> to <span class="token function">clear</span> the current input statement.

mysql<span class="token operator">></span> show databases
    -<span class="token operator">></span> <span class="token punctuation">;</span>
+--------------------+
<span class="token operator">|</span> Database           <span class="token operator">|</span>
+--------------------+
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
+--------------------+
4 rows <span class="token keyword">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> quit
Bye</code></pre>
<h3 id="7-6-在mysql数据库创建相应的用户和DB"><a href="#7-6-在mysql数据库创建相应的用户和DB" class="headerlink" title="7.6 在mysql数据库创建相应的用户和DB"></a>7.6 在mysql数据库创建相应的用户和DB</h3><h4 id="7-6-1-创建ambari数据库及数据库的用户名和密码"><a href="#7-6-1-创建ambari数据库及数据库的用户名和密码" class="headerlink" title="7.6.1 创建ambari数据库及数据库的用户名和密码"></a>7.6.1 创建ambari数据库及数据库的用户名和密码</h4><pre class=" language-bash"><code class="language-bash">mysql<span class="token operator">></span> <span class="token keyword">set</span> global validate_password_policy<span class="token operator">=</span>0<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> <span class="token keyword">set</span> global validate_password_length<span class="token operator">=</span>1<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> create database ambari character <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
Query OK, 1 row affected <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> CREATE USER <span class="token string">'ambari'</span>@<span class="token string">'%'</span>IDENTIFIED BY <span class="token string">'Ambari123'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> GRANT ALL PRIVILEGES ON ambari.* TO <span class="token string">'ambari'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> FLUSH PRIVILEGES<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span></code></pre>
<h4 id="7-6-2-创建hive数据库及hive库的用户名和密码"><a href="#7-6-2-创建hive数据库及hive库的用户名和密码" class="headerlink" title="7.6.2 创建hive数据库及hive库的用户名和密码"></a>7.6.2 创建hive数据库及hive库的用户名和密码</h4><pre class=" language-bash"><code class="language-bash">mysql<span class="token operator">></span> create database hive character <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
Query OK, 1 row affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> CREATE USER <span class="token string">'hive'</span>@<span class="token string">'%'</span>IDENTIFIED BY <span class="token string">'Hive123'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> GRANT ALL PRIVILEGES ON hive.* TO <span class="token string">'hive'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> FLUSH PRIVILEGES<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span></code></pre>
<h4 id="7-6-3-创建oozie数据库及oozie库的用户名和密码"><a href="#7-6-3-创建oozie数据库及oozie库的用户名和密码" class="headerlink" title="7.6.3 创建oozie数据库及oozie库的用户名和密码"></a>7.6.3 创建oozie数据库及oozie库的用户名和密码</h4><pre class=" language-bash"><code class="language-bash">mysql<span class="token operator">></span> create database oozie character <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
Query OK, 1 row affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> CREATE USER <span class="token string">'oozie'</span>@<span class="token string">'%'</span>IDENTIFIED BY <span class="token string">'Oozie123'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> GRANT ALL PRIVILEGES ON oozie.* TO <span class="token string">'oozie'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> FLUSH PRIVILEGES<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span></code></pre>
<h4 id="7-6-4-创建ranger数据库及ranger库的用户名和密码（不用创建）"><a href="#7-6-4-创建ranger数据库及ranger库的用户名和密码（不用创建）" class="headerlink" title="7.6.4 创建ranger数据库及ranger库的用户名和密码（不用创建）"></a>7.6.4 创建ranger数据库及ranger库的用户名和密码（不用创建）</h4><pre class=" language-bash"><code class="language-bash">mysql<span class="token operator">></span> create database ranger character <span class="token keyword">set</span> utf8<span class="token punctuation">;</span>
Query OK, 1 row affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> CREATE USER <span class="token string">'rangeradmin'</span>@<span class="token string">'%'</span>IDENTIFIED BY <span class="token string">'Ranger123'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> GRANT ALL PRIVILEGES ON rangeradmin.* TO <span class="token string">'rangeradmin'</span>@<span class="token string">'%'</span><span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span> FLUSH PRIVILEGES<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span>
mysql<span class="token operator">></span> show databases<span class="token punctuation">;</span>
+--------------------+
<span class="token operator">|</span> Database           <span class="token operator">|</span>
+--------------------+
<span class="token operator">|</span> information_schema <span class="token operator">|</span>
<span class="token operator">|</span> ambari             <span class="token operator">|</span>
<span class="token operator">|</span> hive               <span class="token operator">|</span>
<span class="token operator">|</span> mysql              <span class="token operator">|</span>
<span class="token operator">|</span> oozie              <span class="token operator">|</span>
<span class="token operator">|</span> performance_schema <span class="token operator">|</span>
<span class="token operator">|</span> ranger             <span class="token operator">|</span>
<span class="token operator">|</span> sys                <span class="token operator">|</span>
+--------------------+
8 rows <span class="token keyword">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span>0.01 sec<span class="token punctuation">)</span>


</code></pre>
<h4 id="7-6-5-下载mysql-connection-java"><a href="#7-6-5-下载mysql-connection-java" class="headerlink" title="7.6.5 下载mysql-connection-java"></a>7.6.5 下载mysql-connection-java</h4><pre class=" language-bash"><code class="language-bash">
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> yum <span class="token function">install</span> mysql-connector-java
已加载插件：fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.aliyun.com
 * extras: mirrors.aliyun.com
<span class="token punctuation">..</span>.
完毕！

<span class="token comment" spellcheck="true"># 检查文件是否存在</span>

<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> <span class="token function">ls</span> /usr/share/java
mysql-connector-java.jar

</code></pre>
<h3 id="7-7-下载所需安装文件"><a href="#7-7-下载所需安装文件" class="headerlink" title="7.7 下载所需安装文件"></a>7.7 下载所需安装文件</h3><pre class=" language-bash"><code class="language-bash">
<span class="token function">wget</span> http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.7.3.0/ambari-2.7.3.0-centos7.tar.gz

<span class="token function">wget</span> http://public-repo-1.hortonworks.com/HDP/centos7/3.x/updates/3.1.0.0/HDP-3.1.0.0-centos7-rpm.tar.gz

<span class="token function">wget</span> http://public-repo-1.hortonworks.com/HDP-UTILS-1.1.0.22/repos/centos7/HDP-UTILS-1.1.0.22-centos7.tar.gz

<span class="token comment" spellcheck="true">#查看下载好的文件</span>

<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> ll -rth
-rw-r--r--. 1 root root  87M 3月  30 21:50 HDP-UTILS-1.1.0.22-centos7.tar.gz
-rw-r--r--. 1 root root 1.9G 3月  30 21:51 ambari-2.7.3.0-centos7.tar.gz
-rw-r--r--. 1 root root 8.5G 3月  30 21:52 HDP-3.1.0.0-centos7-rpm.tar.gz
</code></pre>
<h2 id="8-安装yum相关工具"><a href="#8-安装yum相关工具" class="headerlink" title="8. 安装yum相关工具"></a>8. 安装yum相关工具</h2><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> yum <span class="token function">install</span> yum-utils -y
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> yum repolist
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> yum <span class="token function">install</span> createrepo -y
</code></pre>
<h2 id="9-安装Apache-httpd"><a href="#9-安装Apache-httpd" class="headerlink" title="9. 安装Apache httpd"></a>9. 安装Apache httpd</h2><h3 id="9-1-安装"><a href="#9-1-安装" class="headerlink" title="9.1  安装"></a>9.1  安装</h3><pre class=" language-bash"><code class="language-bash">
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span> yum <span class="token function">install</span> httpd -y
已加载插件：fastestmirror
Loading mirror speeds from cached hostfile
<span class="token punctuation">..</span>.
完毕！

<span class="token comment" spellcheck="true"># 安装完成后，会生成 /var/www/html 目录（相当于Tomcat的webapps目录）</span>
<span class="token comment" spellcheck="true"># 进入到/var/www/html目录下，创建ambari和hdp目录，用来存放安装文件。</span>

<span class="token function">cd</span> /var/www/html
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span>
总用量 0
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> <span class="token function">pwd</span>
/var/www/html
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> <span class="token function">mkdir</span> ambari
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> <span class="token function">mkdir</span> hdp
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> <span class="token function">mkdir</span> hdp/HDP-UTILS-1.1.0.22
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 将下载好的文件解压到对应目录</span>

<span class="token function">tar</span> -zxvf ambari-2.7.3.0-centos7.tar.gz -C /var/www/html/ambari/
<span class="token function">tar</span> -zxvf HDP-3.1.0.0-centos7-rpm.tar.gz -C /var/www/html/hdp/
<span class="token function">tar</span> -zxvf HDP-UTILS-1.1.0.22-centos7.tar.gz -C /var/www/html/hdp/HDP-UTILS-1.1.0.22/
</code></pre>
<h3 id="9-2-启动"><a href="#9-2-启动" class="headerlink" title="9.2 启动"></a>9.2 启动</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 启动httpd</span>
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> systemctl start httpd
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 查看httpd状态</span>
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> systemctl status httpd
● httpd.service - The Apache HTTP Server
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/httpd.service<span class="token punctuation">;</span> disabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since 一 2020-03-30 20:46:31 CST<span class="token punctuation">;</span> 6s ago
     Docs: man:httpd<span class="token punctuation">(</span>8<span class="token punctuation">)</span>
           man:apachectl<span class="token punctuation">(</span>8<span class="token punctuation">)</span>
 Main PID: 1845 <span class="token punctuation">(</span>httpd<span class="token punctuation">)</span>
   Status: <span class="token string">"Processing requests..."</span>
   CGroup: /system.slice/httpd.service
           ├─1845 /usr/sbin/httpd -DFOREGROUND
           ├─1846 /usr/sbin/httpd -DFOREGROUND
           ├─1847 /usr/sbin/httpd -DFOREGROUND
           ├─1848 /usr/sbin/httpd -DFOREGROUND
           ├─1849 /usr/sbin/httpd -DFOREGROUND
           └─1850 /usr/sbin/httpd -DFOREGROUND

3月 30 20:46:31 hnode1 systemd<span class="token punctuation">[</span>1<span class="token punctuation">]</span>: Starting The Apache HTTP Server<span class="token punctuation">..</span>.
3月 30 20:46:31 hnode1 httpd<span class="token punctuation">[</span>1845<span class="token punctuation">]</span>: AH00558: httpd: Could not reliably determine the 
server<span class="token string">'s fully qualified domain name, using ::1. Set the '</span>ServerName' directive globally to suppress this message
3月 30 20:46:31 hnode1 systemd<span class="token punctuation">[</span>1<span class="token punctuation">]</span>: Started The Apache HTTP Server.
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span>

<span class="token comment" spellcheck="true"># 设置httpd开机自启</span>
<span class="token punctuation">[</span>root@hnode1 html<span class="token punctuation">]</span> systemctl <span class="token function">enable</span> httpd
</code></pre>
<h3 id="9-3-访问"><a href="#9-3-访问" class="headerlink" title="9.3 访问"></a>9.3 访问</h3><p>浏览器输入：<a href="http://ip地址（默认端口80）" target="_blank" rel="noopener">http://ip地址（默认端口80）</a></p>
<p><img src="https://images.hnbian.cn/FhceKjJePliKeCWRpR7WsJtNlV2C?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="httpd 首页"></p>
<p><img src="https://images.hnbian.cn/Fq_xwGjK52_pQrl0P4XwdvynRJZ-?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="Ambari"></p>
<h2 id="10-配置本地-Repo"><a href="#10-配置本地-Repo" class="headerlink" title="10. 配置本地 Repo"></a>10. 配置本地 Repo</h2><h3 id="10-1-配置Ambari"><a href="#10-1-配置Ambari" class="headerlink" title="10.1 配置Ambari"></a>10.1 配置Ambari</h3><pre class=" language-bash"><code class="language-bash">
<span class="token function">wget</span> -O /etc/yum.repos.d/ambari.repo http://public-repo-1.hortonworks.com/ambari/centos7/2.x/updates/2.7.3.0/ambari.repo
<span class="token punctuation">..</span>.
正在解析主机 public <span class="token punctuation">..</span>.
<span class="token punctuation">..</span>.
100%<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">]</span> 376         --.-K/s 用时 0s

2020-03-30 22:20:10 <span class="token punctuation">(</span>76.0 MB/s<span class="token punctuation">)</span> - 已保存 “/etc/yum.repos.d/ambari.repo” <span class="token punctuation">[</span>376/376<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># 修改配置文件</span>
vim /etc/yum.repos.d/ambari.repo

<span class="token comment" spellcheck="true">#VERSION_NUMBER=2.7.3.0-139</span>
<span class="token punctuation">[</span>ambari-2.7.3.0<span class="token punctuation">]</span>
<span class="token comment" spellcheck="true">#json.url = http://public-repo-1.hortonworks.com/HDP/hdp_urlinfo.json</span>
name<span class="token operator">=</span>ambari Version - ambari-2.7.3.0

<span class="token comment" spellcheck="true">#修改host 地址</span>
baseurl<span class="token operator">=</span>http://hnode1/ambari/ambari/centos7/2.7.3.0-139
gpgcheck<span class="token operator">=</span>1

<span class="token comment" spellcheck="true">#修改host 地址</span>
gpgkey<span class="token operator">=</span>http://hnode1/ambari/ambari/centos7/2.7.3.0-139/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled<span class="token operator">=</span>1
priority<span class="token operator">=</span>1

<span class="token comment" spellcheck="true"># 地址配置完成之后可以在浏览器里面检查一下是否能够正常访问</span>
</code></pre>
<h3 id="10-2-配置HDP和HDP-UTILS"><a href="#10-2-配置HDP和HDP-UTILS" class="headerlink" title="10.2 配置HDP和HDP-UTILS"></a>10.2 配置HDP和HDP-UTILS</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 创建配置文件</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> vim /etc/yum.repos.d/ambari.repo
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span>
<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> <span class="token function">ls</span> /etc/yum.repos.d/ <span class="token operator">|</span> <span class="token function">grep</span> HDP.repo
HDP.repo

<span class="token comment" spellcheck="true"># 文件内添加如下添加内容：</span>

<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> vim /etc/yum.repos.d/HDP.repo

<span class="token comment" spellcheck="true">#VERSION_NUMBER=3.1.0.0-78</span>
<span class="token punctuation">[</span>HDP-3.1.0.0<span class="token punctuation">]</span>
name<span class="token operator">=</span>HDP Version - HDP-3.1.0.0
baseurl<span class="token operator">=</span>http://hnode1/hdp/HDP/centos7
gpgcheck<span class="token operator">=</span>1
gpgkey<span class="token operator">=</span>http://hnode1/hdp/HDP/centos7/3.1.0.0-78/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled<span class="token operator">=</span>1
priority<span class="token operator">=</span>1

<span class="token punctuation">[</span>HDP-UTILS-1.1.0.22<span class="token punctuation">]</span>
name<span class="token operator">=</span>HDP-UTILS Version - HDP-UTILS-1.1.0.22
baseurl<span class="token operator">=</span>http://hnode1/hdp/HDP-UTILS-1.1.0.22
gpgcheck<span class="token operator">=</span>1
gpgkey<span class="token operator">=</span>http://hnode1/hdp/HDP-UTILS-1.1.0.22/HDP-UTILS/centos7/1.1.0.22/RPM-GPG-KEY/RPM-GPG-KEY-Jenkins
enabled<span class="token operator">=</span>1
priority<span class="token operator">=</span>1
</code></pre>
<h3 id="10-3-分发Ambari-repo和HDP-repo"><a href="#10-3-分发Ambari-repo和HDP-repo" class="headerlink" title="10.3 分发Ambari.repo和HDP.repo"></a>10.3 分发Ambari.repo和HDP.repo</h3><pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 把ambari.repo HDP.repo分发到各个节点的相同目录下</span>

<span class="token punctuation">[</span>root@hnode1 opt<span class="token punctuation">]</span> <span class="token function">cd</span> /etc/yum.repos.d
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span> <span class="token function">scp</span> ambari.repo HDP.repo hnode2:<span class="token variable">$PWD</span>
ambari.repo                                          100%  524   415.4KB/s   00:00
HDP.repo                                             100%  469   227.5KB/s   00:00
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span> <span class="token function">scp</span> ambari.repo HDP.repo hnode3:<span class="token variable">$PWD</span>
ambari.repo                                          100%  524   279.6KB/s   00:00
HDP.repo                                             100%  469   295.9KB/s   00:00
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span>


<span class="token comment" spellcheck="true"># node2 查看文件是否成功分发</span>
<span class="token punctuation">[</span>root@hnode2 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ll</span>
-rw-r--r--. 1 root root  524 3月  30 22:31 ambari.repo
-rw-r--r--. 1 root root 1664 9月   5 2019 CentOS-Base.repo
<span class="token punctuation">..</span>.
-rw-r--r--. 1 root root  469 3月  30 22:31 HDP.repo


<span class="token comment" spellcheck="true"># node3 查看文件是否成功分发</span>
<span class="token punctuation">[</span>root@hnode3 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ll</span>
-rw-r--r--. 1 root root  524 3月  30 22:31 ambari.repo
-rw-r--r--. 1 root root 1664 9月   5 2019 CentOS-Base.repo
<span class="token punctuation">..</span>.
-rw-r--r--. 1 root root  469 3月  30 22:31 HDP.repo
</code></pre>
<h3 id="10-4-生成本地源"><a href="#10-4-生成本地源" class="headerlink" title="10.4 生成本地源"></a>10.4 生成本地源</h3><p>使用createrepo命令，创建yum本地源（软件仓库），即为存放本地特定位置的众多rpm包建立索引，描述各包所需依赖信息，并形成元数据。</p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># createrepo /var/www/html/hdp/HDP/centos7/</span>
Spawning worker 0 with 201 pkgs
Workers Finished
Saving Primary metadata
Saving <span class="token function">file</span> lists metadata
Saving other metadata
Generating sqlite DBs
Sqlite DBs complete

<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># createrepo /var/www/html/hdp/HDP-UTILS-1.1.0.22/</span>
Spawning worker 0 with 16 pkgs
Workers Finished
Saving Primary metadata
Saving <span class="token function">file</span> lists metadata
Saving other metadata
Generating sqlite DBs
Sqlite DBs complete</code></pre>
<h2 id="11-安装Ambari-Server"><a href="#11-安装Ambari-Server" class="headerlink" title="11. 安装Ambari-Server"></a>11. 安装Ambari-Server</h2><h3 id="11-1-安装ambari-server"><a href="#11-1-安装ambari-server" class="headerlink" title="11.1 安装ambari-server"></a>11.1 安装ambari-server</h3><pre class=" language-bash"><code class="language-bash">
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum install ambari-server</span>
已加载插件：fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.aliyun.com
 * extras: mirrors.aliyun.com
 * updates: mirrors.aliyun.com
ambari-2.7.3.0                                                            <span class="token operator">|</span> 2.9 kB  00:00:00
ambari-2.7.3.0/primary_db                                                 <span class="token operator">|</span>  25 kB  00:00:00
正在解决依赖关系
--<span class="token operator">></span> 正在检查事务
<span class="token punctuation">..</span>.

依赖关系解决

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
 Package                   架构       版本                   源                        大小
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
正在安装:
 ambari-server             x86_64     2.7.3.0-139            ambari-2.7.3.0           352 M
为依赖而安装:
 postgresql                x86_64     9.2.24-2.el7_7         updates                  3.0 M
 postgresql-libs           x86_64     9.2.24-2.el7_7         updates                  234 k
 postgresql-server         x86_64     9.2.24-2.el7_7         updates                  3.8 M

事务概要
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
安装  1 软件包 <span class="token punctuation">(</span>+3 依赖软件包<span class="token punctuation">)</span>
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token punctuation">(</span>4/4<span class="token punctuation">)</span>: postgresql-server-9.2.24-2.el7_7.x86_64.rpm                        <span class="token operator">|</span> 3.8 MB  00:00:05
--------------------------------------------------------------------------------------------
总计                                                               57 MB/s <span class="token operator">|</span> 359 MB  00:00:06
从 http://hnode1/ambari/ambari/centos7/2.7.3.0-139/RPM-GPG-KEY/RPM-GPG-KEY-Jenkin 检索密钥


获取 GPG 密钥失败：<span class="token punctuation">[</span>Errno 14<span class="token punctuation">]</span> HTTP Error 404 - Not Found
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># vim ambari.repo</span>
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span>
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span>
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span>
<span class="token punctuation">[</span>root@hnode1 yum.repos.d<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum install ambari-server</span>
已加载插件：fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.aliyun.com
 * extras: mirrors.aliyun.com
 * updates: mirrors.aliyun.com
ambari-2.7.3.0                                                            <span class="token operator">|</span> 2.9 kB  00:00:00
正在解决依赖关系
--<span class="token operator">></span> 正在检查事务
---<span class="token operator">></span> 软件包 ambari-server.x86_64.0.2.7.3.0-139 将被 安装
--<span class="token operator">></span> 正在处理依赖关系 postgresql-server <span class="token operator">>=</span> 8.1，它被软件包 ambari-server-2.7.3.0-139.x86_64 需要
--<span class="token operator">></span> 正在检查事务
<span class="token punctuation">..</span>.
--<span class="token operator">></span> 解决依赖关系完成

依赖关系解决

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
 Package                    架构        版本                   源                           大小
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
正在安装:
 ambari-server              x86_64      2.7.3.0-139            ambari-2.7.3.0              352 M
为依赖而安装:
 postgresql                 x86_64      9.2.24-2.el7_7         updates                     3.0 M
 postgresql-libs            x86_64      9.2.24-2.el7_7         updates                     234 k
 postgresql-server          x86_64      9.2.24-2.el7_7         updates                     3.8 M

事务概要
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
安装  1 软件包 <span class="token punctuation">(</span>+3 依赖软件包<span class="token punctuation">)</span>

总计：359 M
安装大小：451 M
Is this ok <span class="token punctuation">[</span>y/d/N<span class="token punctuation">]</span>: y
<span class="token punctuation">..</span>.
是否继续？<span class="token punctuation">[</span>y/N<span class="token punctuation">]</span>：y
Running transaction check
Running transaction <span class="token function">test</span>
Transaction <span class="token function">test</span> succeeded
Running transaction
  正在安装    <span class="token keyword">:</span> postgresql-libs-9.2.24-2.el7_7.x86_64                                 1/4
  正在安装    <span class="token keyword">:</span> postgresql-9.2.24-2.el7_7.x86_64                                      2/4
  正在安装    <span class="token keyword">:</span> postgresql-server-9.2.24-2.el7_7.x86_64                               3/4
  正在安装    <span class="token keyword">:</span> ambari-server-2.7.3.0-139.x86_64                                      4/4
  验证中      <span class="token keyword">:</span> postgresql-server-9.2.24-2.el7_7.x86_64                               1/4
  验证中      <span class="token keyword">:</span> ambari-server-2.7.3.0-139.x86_64                                      2/4
  验证中      <span class="token keyword">:</span> postgresql-libs-9.2.24-2.el7_7.x86_64                                 3/4
  验证中      <span class="token keyword">:</span> postgresql-9.2.24-2.el7_7.x86_64                                      4/4

已安装:
  ambari-server.x86_64 0:2.7.3.0-139
<span class="token punctuation">..</span>.
完毕！
</code></pre>
<h3 id="11-2-配置ambari-server"><a href="#11-2-配置ambari-server" class="headerlink" title="11.2 配置ambari-server"></a>11.2 配置ambari-server</h3><pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ambari-server setup</span>
Using python  /usr/bin/python
Setup ambari-server
Checking SELinux<span class="token punctuation">..</span>.
SELinux status is <span class="token string">'disabled'</span>
Customize user account <span class="token keyword">for</span> ambari-server daemon <span class="token punctuation">[</span>y/n<span class="token punctuation">]</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>? y
Enter user account <span class="token keyword">for</span> ambari-server daemon <span class="token punctuation">(</span>root<span class="token punctuation">)</span>:root
Adjusting ambari-server permissions and ownership<span class="token punctuation">..</span>.
Checking firewall status<span class="token punctuation">..</span>.
Checking JDK<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>1<span class="token punctuation">]</span> Oracle JDK 1.8 + Java Cryptography Extension <span class="token punctuation">(</span>JCE<span class="token punctuation">)</span> Policy Files 8
<span class="token punctuation">[</span>2<span class="token punctuation">]</span> Custom JDK
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Enter choice <span class="token punctuation">(</span>1<span class="token punctuation">)</span>: 2 <span class="token comment" spellcheck="true">#选择自定义jdk</span>
WARNING: JDK must be installed on all hosts and JAVA_HOME must be valid on all hosts.
WARNING: JCE Policy files are required <span class="token keyword">for</span> configuring Kerberos security. If you plan 
to use Kerberos,please <span class="token function">make</span> sure JCE Unlimited Strength Jurisdiction Policy Files are valid on all hosts.
Path to JAVA_HOME: /opt/jdk1.8.0_191 <span class="token comment" spellcheck="true">#JAVA_HOME</span>
Validating JDK on Ambari Server<span class="token punctuation">..</span>.done.
Check JDK version <span class="token keyword">for</span> Ambari Server<span class="token punctuation">..</span>.
JDK version found: 8
Minimum JDK version is 8 <span class="token keyword">for</span> Ambari. Skipping to setup different JDK <span class="token keyword">for</span> Ambari Server.
Checking GPL software agreement<span class="token punctuation">..</span>.
GPL License <span class="token keyword">for</span> LZO: https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html
Enable Ambari Server to download and <span class="token function">install</span> GPL Licensed LZO packages <span class="token punctuation">[</span>y/n<span class="token punctuation">]</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>? y
Completing setup<span class="token punctuation">..</span>.
Configuring database<span class="token punctuation">..</span>.
Enter advanced database configuration <span class="token punctuation">[</span>y/n<span class="token punctuation">]</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>? y <span class="token comment" spellcheck="true">#配置数据库</span>
Configuring database<span class="token punctuation">..</span>.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Choose one of the following options:
<span class="token punctuation">[</span>1<span class="token punctuation">]</span> - PostgreSQL <span class="token punctuation">(</span>Embedded<span class="token punctuation">)</span>
<span class="token punctuation">[</span>2<span class="token punctuation">]</span> - Oracle
<span class="token punctuation">[</span>3<span class="token punctuation">]</span> - MySQL / MariaDB
<span class="token punctuation">[</span>4<span class="token punctuation">]</span> - PostgreSQL
<span class="token punctuation">[</span>5<span class="token punctuation">]</span> - Microsoft SQL Server <span class="token punctuation">(</span>Tech Preview<span class="token punctuation">)</span>
<span class="token punctuation">[</span>6<span class="token punctuation">]</span> - SQL Anywhere
<span class="token punctuation">[</span>7<span class="token punctuation">]</span> - BDB
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Enter choice <span class="token punctuation">(</span>1<span class="token punctuation">)</span>: 3
Hostname <span class="token punctuation">(</span>localhost<span class="token punctuation">)</span>: hnode1 <span class="token comment" spellcheck="true">#mysql hostname</span>
Port <span class="token punctuation">(</span>3306<span class="token punctuation">)</span>: <span class="token comment" spellcheck="true"># mysql 端口 默认 3306</span>
Database name <span class="token punctuation">(</span>ambari<span class="token punctuation">)</span>: <span class="token comment" spellcheck="true">#使用的数据库名称</span>
Username <span class="token punctuation">(</span>ambari<span class="token punctuation">)</span>: <span class="token comment" spellcheck="true">#mysql用户名</span>
Enter Database Password <span class="token punctuation">(</span>bigdata<span class="token punctuation">)</span>: <span class="token comment" spellcheck="true">#密码 前面增加的ambari用户的密码 （Ambari123）</span>
Re-enter password: <span class="token comment" spellcheck="true">#（Ambari123）</span>
Passwords <span class="token keyword">do</span> not match
Enter Database Password <span class="token punctuation">(</span>bigdata<span class="token punctuation">)</span>:
Invalid characters <span class="token keyword">in</span> password. Use only alphanumeric or _ or - characters
Enter Database Password <span class="token punctuation">(</span>bigdata<span class="token punctuation">)</span>:
Re-enter password:
Configuring ambari database<span class="token punctuation">..</span>.
Should ambari use existing default jdbc /usr/share/java/mysql-connector-java.jar <span class="token punctuation">[</span>y/n<span class="token punctuation">]</span> <span class="token punctuation">(</span>y<span class="token punctuation">)</span>? y
Configuring remote database connection properties<span class="token punctuation">..</span>.
WARNING: Before starting Ambari Server, you must run the following DDL directly 
from the database shell to create the schema: /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql
Proceed with configuring remote database connection properties <span class="token punctuation">[</span>y/n<span class="token punctuation">]</span> <span class="token punctuation">(</span>y<span class="token punctuation">)</span>? y
Extracting system views<span class="token punctuation">..</span>.
ambari-admin-2.7.3.0.139.jar
<span class="token punctuation">..</span><span class="token punctuation">..</span>
Ambari repo <span class="token function">file</span> contains latest json url http://public-repo-1.hortonworks.com/HDP/hdp_urlinfo.json, 
   updating stacks repoinfos with it<span class="token punctuation">..</span>.
Adjusting ambari-server permissions and ownership<span class="token punctuation">..</span>.
Ambari Server <span class="token string">'setup'</span> completed successfully.
</code></pre>
<h3 id="11-3-登录MySQL创建执行建表脚本"><a href="#11-3-登录MySQL创建执行建表脚本" class="headerlink" title="11.3 登录MySQL创建执行建表脚本"></a>11.3 登录MySQL创建执行建表脚本</h3><pre class=" language-bash"><code class="language-bash">
<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># mysql -u ambari -p -h hnode1</span>
Enter password:
Welcome to the MySQL monitor.  Commands end with <span class="token punctuation">;</span> or \g.
<span class="token punctuation">..</span>.
mysql<span class="token operator">></span> use ambari<span class="token punctuation">;</span>
Database changed
mysql<span class="token operator">></span> show tables<span class="token punctuation">;</span>
Empty <span class="token keyword">set</span> <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># 执行 Ambari-DDL-MySQL-CREATE.sql 脚本</span>
mysql<span class="token operator">></span> <span class="token function">source</span> /var/lib/ambari-server/resources/Ambari-DDL-MySQL-CREATE.sql<span class="token punctuation">;</span>
Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

Query OK, 0 rows affected <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>

mysql<span class="token operator">></span>

<span class="token comment" spellcheck="true"># 有无报错信息 查看创建的表</span>
mysql<span class="token operator">></span> show tables<span class="token punctuation">;</span>
+-------------------------------+
<span class="token operator">|</span> Tables_in_ambari              <span class="token operator">|</span>
+-------------------------------+
<span class="token operator">|</span> ClusterHostMapping            <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_BLOB_TRIGGERS            <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_CALENDARS                <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_CRON_TRIGGERS            <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_FIRED_TRIGGERS           <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_JOB_DETAILS              <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_LOCKS                    <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_PAUSED_TRIGGER_GRPS      <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_SCHEDULER_STATE          <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_SIMPLE_TRIGGERS          <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_SIMPROP_TRIGGERS         <span class="token operator">|</span>
<span class="token operator">|</span> QRTZ_TRIGGERS                 <span class="token operator">|</span>
<span class="token operator">|</span> adminpermission               <span class="token operator">|</span>
<span class="token operator">|</span> adminprincipal                <span class="token operator">|</span>
<span class="token operator">|</span> adminprincipaltype            <span class="token operator">|</span>
<span class="token operator">|</span> adminprivilege                <span class="token operator">|</span>
<span class="token operator">|</span> adminresource                 <span class="token operator">|</span>
<span class="token operator">|</span> adminresourcetype             <span class="token operator">|</span>
<span class="token operator">|</span> alert_current                 <span class="token operator">|</span>
<span class="token operator">|</span> alert_definition              <span class="token operator">|</span>
<span class="token operator">|</span> alert_group                   <span class="token operator">|</span>
<span class="token operator">|</span> alert_group_target            <span class="token operator">|</span>
<span class="token operator">|</span> alert_grouping                <span class="token operator">|</span>
<span class="token operator">|</span> alert_history                 <span class="token operator">|</span>
<span class="token operator">|</span> alert_notice                  <span class="token operator">|</span>
<span class="token operator">|</span> alert_target                  <span class="token operator">|</span>
<span class="token operator">|</span> alert_target_states           <span class="token operator">|</span>
<span class="token operator">|</span> ambari_configuration          <span class="token operator">|</span>
<span class="token operator">|</span> ambari_operation_history      <span class="token operator">|</span>
<span class="token operator">|</span> ambari_sequences              <span class="token operator">|</span>
<span class="token operator">|</span> artifact                      <span class="token operator">|</span>
<span class="token operator">|</span> blueprint                     <span class="token operator">|</span>
<span class="token operator">|</span> blueprint_configuration       <span class="token operator">|</span>
<span class="token operator">|</span> blueprint_setting             <span class="token operator">|</span>
<span class="token operator">|</span> clusterconfig                 <span class="token operator">|</span>
<span class="token operator">|</span> clusters                      <span class="token operator">|</span>
<span class="token operator">|</span> clusterservices               <span class="token operator">|</span>
<span class="token operator">|</span> clusterstate                  <span class="token operator">|</span>
<span class="token operator">|</span> confgroupclusterconfigmapping <span class="token operator">|</span>
<span class="token operator">|</span> configgroup                   <span class="token operator">|</span>
<span class="token operator">|</span> configgrouphostmapping        <span class="token operator">|</span>
<span class="token operator">|</span> execution_command             <span class="token operator">|</span>
<span class="token operator">|</span> extension                     <span class="token operator">|</span>
<span class="token operator">|</span> extensionlink                 <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">groups</span>                        <span class="token operator">|</span>
<span class="token operator">|</span> host_role_command             <span class="token operator">|</span>
<span class="token operator">|</span> host_version                  <span class="token operator">|</span>
<span class="token operator">|</span> hostcomponentdesiredstate     <span class="token operator">|</span>
<span class="token operator">|</span> hostcomponentstate            <span class="token operator">|</span>
<span class="token operator">|</span> hostconfigmapping             <span class="token operator">|</span>
<span class="token operator">|</span> hostgroup                     <span class="token operator">|</span>
<span class="token operator">|</span> hostgroup_component           <span class="token operator">|</span>
<span class="token operator">|</span> hostgroup_configuration       <span class="token operator">|</span>
<span class="token operator">|</span> hosts                         <span class="token operator">|</span>
<span class="token operator">|</span> hoststate                     <span class="token operator">|</span>
<span class="token operator">|</span> kerberos_descriptor           <span class="token operator">|</span>
<span class="token operator">|</span> kerberos_keytab               <span class="token operator">|</span>
<span class="token operator">|</span> kerberos_keytab_principal     <span class="token operator">|</span>
<span class="token operator">|</span> kerberos_principal            <span class="token operator">|</span>
<span class="token operator">|</span> key_value_store               <span class="token operator">|</span>
<span class="token operator">|</span> kkp_mapping_service           <span class="token operator">|</span>
<span class="token operator">|</span> members                       <span class="token operator">|</span>
<span class="token operator">|</span> metainfo                      <span class="token operator">|</span>
<span class="token operator">|</span> permission_roleauthorization  <span class="token operator">|</span>
<span class="token operator">|</span> remoteambaricluster           <span class="token operator">|</span>
<span class="token operator">|</span> remoteambariclusterservice    <span class="token operator">|</span>
<span class="token operator">|</span> repo_applicable_services      <span class="token operator">|</span>
<span class="token operator">|</span> repo_definition               <span class="token operator">|</span>
<span class="token operator">|</span> repo_os                       <span class="token operator">|</span>
<span class="token operator">|</span> repo_tags                     <span class="token operator">|</span>
<span class="token operator">|</span> repo_version                  <span class="token operator">|</span>
<span class="token operator">|</span> request                       <span class="token operator">|</span>
<span class="token operator">|</span> requestoperationlevel         <span class="token operator">|</span>
<span class="token operator">|</span> requestresourcefilter         <span class="token operator">|</span>
<span class="token operator">|</span> requestschedule               <span class="token operator">|</span>
<span class="token operator">|</span> requestschedulebatchrequest   <span class="token operator">|</span>
<span class="token operator">|</span> role_success_criteria         <span class="token operator">|</span>
<span class="token operator">|</span> roleauthorization             <span class="token operator">|</span>
<span class="token operator">|</span> servicecomponent_version      <span class="token operator">|</span>
<span class="token operator">|</span> servicecomponentdesiredstate  <span class="token operator">|</span>
<span class="token operator">|</span> serviceconfig                 <span class="token operator">|</span>
<span class="token operator">|</span> serviceconfighosts            <span class="token operator">|</span>
<span class="token operator">|</span> serviceconfigmapping          <span class="token operator">|</span>
<span class="token operator">|</span> servicedesiredstate           <span class="token operator">|</span>
<span class="token operator">|</span> setting                       <span class="token operator">|</span>
<span class="token operator">|</span> stack                         <span class="token operator">|</span>
<span class="token operator">|</span> stage                         <span class="token operator">|</span>
<span class="token operator">|</span> topology_host_info            <span class="token operator">|</span>
<span class="token operator">|</span> topology_host_request         <span class="token operator">|</span>
<span class="token operator">|</span> topology_host_task            <span class="token operator">|</span>
<span class="token operator">|</span> topology_hostgroup            <span class="token operator">|</span>
<span class="token operator">|</span> topology_logical_request      <span class="token operator">|</span>
<span class="token operator">|</span> topology_logical_task         <span class="token operator">|</span>
<span class="token operator">|</span> topology_request              <span class="token operator">|</span>
<span class="token operator">|</span> upgrade                       <span class="token operator">|</span>
<span class="token operator">|</span> upgrade_group                 <span class="token operator">|</span>
<span class="token operator">|</span> upgrade_history               <span class="token operator">|</span>
<span class="token operator">|</span> upgrade_item                  <span class="token operator">|</span>
<span class="token operator">|</span> user_authentication           <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token function">users</span>                         <span class="token operator">|</span>
<span class="token operator">|</span> viewentity                    <span class="token operator">|</span>
<span class="token operator">|</span> viewinstance                  <span class="token operator">|</span>
<span class="token operator">|</span> viewinstancedata              <span class="token operator">|</span>
<span class="token operator">|</span> viewinstanceproperty          <span class="token operator">|</span>
<span class="token operator">|</span> viewmain                      <span class="token operator">|</span>
<span class="token operator">|</span> viewparameter                 <span class="token operator">|</span>
<span class="token operator">|</span> viewresource                  <span class="token operator">|</span>
<span class="token operator">|</span> viewurl                       <span class="token operator">|</span>
<span class="token operator">|</span> widget                        <span class="token operator">|</span>
<span class="token operator">|</span> widget_layout                 <span class="token operator">|</span>
<span class="token operator">|</span> widget_layout_user_widget     <span class="token operator">|</span>
+-------------------------------+
111 rows <span class="token keyword">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span>0.00 sec<span class="token punctuation">)</span>
</code></pre>
<h3 id="11-4-启动Ambari-Server"><a href="#11-4-启动Ambari-Server" class="headerlink" title="11.4 启动Ambari-Server"></a>11.4 启动Ambari-Server</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>启动命令</td>
<td>ambari-server start</td>
</tr>
<tr>
<td>停止命令</td>
<td>ambari-server stop</td>
</tr>
<tr>
<td>查看状态</td>
<td>ambari-server status</td>
</tr>
<tr>
<td>重启命令</td>
<td>ambari-server restart</td>
</tr>
</tbody></table>
<ul>
<li>ambari-server<ul>
<li>start</li>
<li>stop</li>
<li>reset</li>
<li>restart</li>
<li>upgrade</li>
<li>status</li>
<li>upgradestack</li>
<li>setup</li>
<li>setup-jce</li>
<li>setup-ldap</li>
<li>sync-ldap</li>
<li>set-current</li>
<li>setup-security</li>
<li>refresh-stack-hash</li>
<li>backup</li>
<li>restore</li>
<li>update-host-names</li>
<li>check-database</li>
<li>enable-stack</li>
<li>setup-sso</li>
<li>db-purge-history</li>
<li>install-mpack</li>
<li>uninstall-mpack</li>
<li>upgrade-mpack</li>
<li>setup-kerberos</li>
<li>setup-pam</li>
<li>migrate-ldap-pam</li>
</ul>
</li>
</ul>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ambari-server start</span>
<span class="token comment" spellcheck="true"># 如果启动失败，关闭服务【ambari-server stop】，重新启动</span>
Using python  /usr/bin/python
Starting ambari-server
Ambari Server running with administrator privileges.
Organizing resource files at /var/lib/ambari-server/resources<span class="token punctuation">..</span>.
Ambari database consistency check started<span class="token punctuation">..</span>.
Server PID at: /var/run/ambari-server/ambari-server.pid
Server out at: /var/log/ambari-server/ambari-server.out
Server log at: /var/log/ambari-server/ambari-server.log
Waiting <span class="token keyword">for</span> server start<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
Server started listening on 8080

DB configs consistency check: no errors and warnings were found.
Ambari Server <span class="token string">'start'</span> completed successfully.</code></pre>
<p><a href="http://hnode1:8080" target="_blank" rel="noopener">http://hnode1:8080</a><br><img src="https://images.hnbian.cn/FoG2Bf9FIQXimUeyS9NZ67IvtUjj?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="Ambari 登录页"></p>
<h3 id="11-5-安装Agent"><a href="#11-5-安装Agent" class="headerlink" title="11.5 安装Agent"></a>11.5 安装Agent</h3><table>
<thead>
<tr>
<th>功能</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>启动命令</td>
<td>service ambari-agent start</td>
</tr>
<tr>
<td>停止命令</td>
<td>service ambari-agent stop</td>
</tr>
<tr>
<td>查看状态</td>
<td>service ambari-agent status</td>
</tr>
<tr>
<td>重启命令</td>
<td>service ambari-agent restart</td>
</tr>
</tbody></table>
<pre class=" language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 在每个计算节点都要安装 agent</span>

<span class="token punctuation">[</span>root@hnode1 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum -y install ambari-agent</span>
已加载插件：fastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.aliyun.com
 * extras: mirrors.aliyun.com
 * updates: mirrors.aliyun.com
HDP-3.1.0.0                                                 <span class="token operator">|</span> 2.9 kB  00:00:00
HDP-UTILS-1.1.0.22                                          <span class="token operator">|</span> 2.9 kB  00:00:00
ambari-2.7.3.0                                              <span class="token operator">|</span> 2.9 kB  00:00:00
base                                                        <span class="token operator">|</span> 3.6 kB  00:00:00
extras                                                      <span class="token operator">|</span> 2.9 kB  00:00:00
mysql-connectors-community                                  <span class="token operator">|</span> 2.5 kB  00:00:00
mysql-tools-community                                       <span class="token operator">|</span> 2.5 kB  00:00:00
mysql57-community                                           <span class="token operator">|</span> 2.5 kB  00:00:00
updates                                                     <span class="token operator">|</span> 2.9 kB  00:00:00
正在解决依赖关系
--<span class="token operator">></span> 正在检查事务
---<span class="token operator">></span> 软件包 ambari-agent.x86_64.0.2.7.3.0-139 将被 安装
--<span class="token operator">></span> 解决依赖关系完成

依赖关系解决

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
 Package            架构          版本               源                     大小
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
正在安装:
 ambari-agent       x86_64        2.7.3.0-139        ambari-2.7.3.0         36 M

事务概要
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
安装  1 软件包

总下载量：36 M
安装大小：68 M
Downloading packages:
ambari-agent-2.7.3.0-139.x86_64.rpm                           <span class="token operator">|</span>  36 MB  00:00:00
Running transaction check
Running transaction <span class="token function">test</span>
Transaction <span class="token function">test</span> succeeded
Running transaction
  正在安装    <span class="token keyword">:</span> ambari-agent-2.7.3.0-139.x86_64                                1/1
  验证中      <span class="token keyword">:</span> ambari-agent-2.7.3.0-139.x86_64                                1/1

已安装:
  ambari-agent.x86_64 0:2.7.3.0-139

完毕！</code></pre>
<h2 id="12-集群安装"><a href="#12-集群安装" class="headerlink" title="12. 集群安装"></a>12. 集群安装</h2><p><img src="https://images.hnbian.cn/FlOAKZlR0xsux6Xkj3gQhUg-Eaqt?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="启用安装向导创建集群"></p>
<p><img src="https://images.hnbian.cn/Fpdvb-0RLKBiL95InN532ADLJaCX?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="配置集群名称"></p>
<p><img src="https://images.hnbian.cn/Fj_0pVRyJgpLQB-enRiYB_CYaYlR?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="选择版本,配置仓库地址"></p>
<ul>
<li><a href="http://hnode1/hdp/HDP/centos7/" target="_blank" rel="noopener">http://hnode1/hdp/HDP/centos7/</a></li>
<li><a href="http://public-repo-1.hortonworks.com/HDP-GPL/centos7/3.x/updates/3.1.0.0" target="_blank" rel="noopener">http://public-repo-1.hortonworks.com/HDP-GPL/centos7/3.x/updates/3.1.0.0</a></li>
<li><a href="http://hnode1/hdp/HDP-UTILS-1.1.0.22/" target="_blank" rel="noopener">http://hnode1/hdp/HDP-UTILS-1.1.0.22/</a></li>
</ul>
<p><img src="https://images.hnbian.cn/FgnzlsjfYvhEVM1Uk0VLpxxaVch4?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="配置集群节点与秘钥"></p>
<p><img src="https://images.hnbian.cn/Fk2VS74xQRZzpzuoCv-Ue9dMueuU?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="确认主机"></p>
<p>这个步骤可能会出现如下错误:</p>
<pre class=" language-bash"><code class="language-bash">ERROR 2020-04-05 15:04:48,778 main.py:269 - Ambari agent machine <span class="token function">hostname</span> <span class="token punctuation">(</span>localhost.localdomain<span class="token punctuation">)</span> does not match expected ambari server <span class="token function">hostname</span> <span class="token punctuation">(</span>hnode1<span class="token punctuation">)</span>. Aborting registration. Please check hostname, <span class="token function">hostname</span> -f and /etc/hosts <span class="token function">file</span> to confirm your <span class="token function">hostname</span> is setup correctly

<span class="token comment" spellcheck="true"># 请检查hostname的配置</span></code></pre>
<p><img src="https://images.hnbian.cn/Fsw8GDX3e23TPpI0A6VscoIOFf80?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="选择要安装的组件"></p>
<p>如果某个服务A 依赖服务B，而你没有选择安装服务B， 会提示安装服务B</p>
<p><img src="https://images.hnbian.cn/FliY60yTnxJ8Q-iNBI_b2ZN84Ai2?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="节点服务分配"></p>
<p><img src="https://images.hnbian.cn/Fs9DjR0cEEb7RAIkktGiEBWdARML?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="分配Slaves 和 Clients"></p>
<p><img src="https://images.hnbian.cn/Fq8q70BlNIAr0tNBwtv0A_pZTQW_?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，配置用户密码"></p>
<pre class=" language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@hnode1 .ssh<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ambari-server setup --jdbc-db=mysql --jdbc-driver=/usr/share/java/mysql-connector-java.jar</span>
Using python  /usr/bin/python
Setup ambari-server
Copying /usr/share/java/mysql-connector-java.jar to /var/lib/ambari-server/resources/mysql-connector-java.jar
If you are updating existing jdbc driver jar <span class="token keyword">for</span> mysql with mysql-connector-java.jar. Please remove the old driver jar, 
 from all hosts. Restarting services that need the driver, will automatically copy the new jar to the hosts.
JDBC driver was successfully initialized.
Ambari Server <span class="token string">'setup'</span> completed successfully.</code></pre>
<p><img src="https://images.hnbian.cn/Fm7pVv6gaqanr4LXHtyRwBWTtT_8?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，相关路径配置"></p>
<p><img src="https://images.hnbian.cn/Fpx8gO3slnv-F1aoT6pv0tDXQYHp?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，用户配置"></p>
<p><img src="https://images.hnbian.cn/Fvlg62s4eLloysRzQARcfsplfvty?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="定制服务，资源配置"></p>
<p><img src="https://images.hnbian.cn/Fl33w-pC2sk_XYprV4evZpV9fIIw?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="查看概况，部署服务"></p>
<p><img src="https://images.hnbian.cn/FqzsW1Xw_y6ETX2OzpWgKZ6WXsIc?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="安装完成"></p>
<p>有些警告可以在后面调整集群</p>
<p><img src="https://images.hnbian.cn/FlislZiU8iBem1ybuvTF-3HSuY2Z?imageView2/0/interlace/1/q/70%7Cwatermark/2/text/d3d3LmhuYmlhbi5jbg==/font/5b6u6L2v6ZuF6buR/fontsize/600/fill/IzBDMjU2NA==/dissolve/100/gravity/SouthEast/dx/10/dy/10%7Cimageslim" alt="安装完成，概览安装的服务"></p>
<p><img src="https://images.hnbian.cn/Fh2OWFNJNxJdEiSedt9SrIXY2F8K" alt="监视页面"></p>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kity@2.0.4/dist/kity.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text/javascript" src="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/hexo-simple-mindmap@0.2.0/dist/mindmap.min.css">
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://www.hnbian.cn" rel="external nofollow noreferrer">hnbian</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://www.hnbian.cn/posts/f09c2b77.html">https://www.hnbian.cn/posts/f09c2b77.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://www.hnbian.cn" target="_blank">hnbian</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/ambari/">
                                    <span class="chip bg-color">ambari</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'h1rND3bHC0OqFwzm1UfPQpaY-gzGzoHsz',
        appKey: 'd7uboDt2WLV2HJCEMHkkLuU4',
        notify: 'true' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'identicon',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: ' 写点什么吧 . . .'
    });
</script>

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/posts/e3f2dd8c.html">
                    <div class="card-image">
                        
                        <img src="https://images.hnbian.cn/FmR6s8_bvNEgKbWJ3i9XeQxnr0uu" class="responsive-img" alt="JVM系列（七）、不同的引用类型">
                        
                        <span class="card-title">JVM系列（七）、不同的引用类型</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            1. JVM中引用的介绍在java中，除了基本数据类型的变量外，其他所有的变量都是引用类型，指向堆中各种不同的对象。
在jvm中，除了我们常用的强引用外，还有软引用、弱引用、虚引用，这四种引用类型的生命周期与jvm的垃圾回收过程息息相关。

                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-03-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/java/" class="post-category">
                                    java
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/java/">
                        <span class="chip bg-color">java</span>
                    </a>
                    
                    <a href="/tags/jvm/">
                        <span class="chip bg-color">jvm</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/posts/77e7a883.html">
                    <div class="card-image">
                        
                        <img src="https://images.hnbian.cn/FjiMWJ33LzWghQ2Ej7iqT_zXuXID" class="responsive-img" alt="Kafka总结（七）Kafka监控kafka-manager介绍">
                        
                        <span class="card-title">Kafka总结（七）Kafka监控kafka-manager介绍</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            1. kafka-manager介绍CMAK（Cluster Manager for Apache Kafka，以前称为Kafka Manager），是用于管理Apache Kafka群集的工具。在监控介绍阶段我们介绍一下kafka Man
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-02-23
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/kafka/" class="post-category">
                                    kafka
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/kafka/">
                        <span class="chip bg-color">kafka</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->


<!-- 代码块收缩 -->


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://images.hnbian.cn/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4, h5'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4, h5').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2018</span>
            <a href="https://www.hnbian.cn" target="_blank">hnbian</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">834.2k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2018";
                    var startMonth = "2";
                    var startDate = "08";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="https://beian.miit.gov.cn" target="_blank">粤ICP备18156920号-2</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/hnbian" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:hnbian@126.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://images.hnbian.cn/materialize.min.js"></script>
    <script src="https://images.hnbian.cn/masonry.pkgd.min.js"></script>
    <script src="https://images.hnbian.cn/aos.js"></script>
    <script src="https://images.hnbian.cn/scrollProgress.min.js"></script>
    <script src="https://images.hnbian.cn/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155985521-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-155985521-1');
    </script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="https://images.hnbian.cn/clicklove.js" async="async"></script>
    
    
    <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    <script type="text/javascript" src="https://images.hnbian.cn/ribbon-dynamic.js" async="async"></script>
    
    
    
    <script src="https://images.hnbian.cn/instantpage.js" type="module"></script>
    

</body>

</html>
